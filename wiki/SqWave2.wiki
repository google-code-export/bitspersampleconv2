#summary 矩形波の入ったWAVファイルを出力するツールSqWave2


= 説明 =

!SqWave2は矩形波の入ったWAVファイルを出力するツールです。

!WaveGene 1.40の矩形波出力波形に納得いかない感じだったので作りました。

= 使用方法 =

http://bitspersampleconv2.googlecode.com/files/SqWave10004.zip
をダウンロードして、中に入っているsetup.exeを実行するとインストールされます。

デスクトップに!SqWave2という名前のショートカットが作られますのでこれをダブルクリックします。あとは画面の指示に従ってWAVファイルを出力します。

アンインストールは、コントロールパネルの[プログラムと機能]から!SqWave2を選んでアンインストールを選択するとできます。

既に旧バージョンの!SqWaveがインストールされている状態で、
最新バージョンに更新したい場合、
最新バージョンをインストールする前に旧バージョンを手動でアンインストールする必要はありません。
最新バージョンを普通にインストールすると、インストーラーが全自動で旧バージョンをアンインストールしてから最新バージョンをインストールします。さらに言うと、この場合zipの中に入っているsetup.exeではなく!SqWave2Setup.msiをダブルクリックしてインストールすると、.NET Framework 4がPCに入っているかどうかをチェックしないので、インストールが早くできて良いです。

http://bitspersampleconv2.googlecode.com/files/SqWave10004ss.png

== !SqWave2の出力波形とスペクトル(192kHzサンプリング、矩形波、10kHz、-10dB) ==

http://bitspersampleconv2.googlecode.com/files/sqwave2WaveForm.png

↑図1

http://bitspersampleconv2.googlecode.com/files/spectrum.png

↑図2

== 参考：!WaveGene 1.40の出力波形とスペクトル(192kHzサンプリング、矩形波、10kHz、-10dB) ==

http://bitspersampleconv2.googlecode.com/files/WG_WaveForm2.png

↑図3

図1と図3を見比べると、!WaveGeneは綺麗な矩形波だし、!SqWave2はガタガタじゃん、
と思われるかもしれませんが、図1と図3の青い実線の波形は、たいした意味はなく、
DACのアナログ出力にこの波形が出るわけではないです。(DACの出力波形の綺麗さについては図5で比較できます。)

http://bitspersampleconv2.googlecode.com/files/spectrum_wg.png

↑図4

↑エイリアシング歪が生じています。これだけ大きな音量で関係ない周波数成分が含まれていると、耳で聞いてもわかります。

== !SqWave2と!WaveGeneの出力を16倍オーバーサンプルした波形を比較 ==

http://bitspersampleconv2.googlecode.com/files/16xoversample.png

↑図5

(192kHzサンプリング、矩形波、10kHz、-10dB。上が!SqWave2、下が!WaveGene)

DACのアナログ出力からは、大体図5のような波形が出ます。
!SqWave2の出力波形は!WaveGeneよりも安定しています。

なお、16倍オーバーサンプリングはsndfile-resampleを用いて以下のようにして行いました。
sndfile-resampleは極めて高精度なリサンプルができるのでおすすめです。
{{{
sndfile-resample -by 8 -c 0 SQ10K_192.wav SQ10K_1536.wav
sndfile-resample -by 8 -c 0 WG10K_192.wav WG10K_1536.wav
}}}

= ソースコード =

SVNリポジトリに入っています。

このプログラムは.NET Framework 4を使用して作りました。

このあたりで矩形波を作っています。

http://code.google.com/p/bitspersampleconv2/source/browse/trunk/sqwave2/sqwave2/MainWindow.xaml.cs#354

= 更新履歴 =

=== !SqWave2 バージョン 1.0.4 ===
  * 級数加算打ち切り周波数をナイキスト周波数との比の％で入力できるようにしました。

=== !SqWave2 バージョン 1.0.2 ===
  * のこぎり波、三角波もでるようにしました。

=== !SqWave2 バージョン 1.0.1 ===
  * ダイアログに入れられた値の範囲チェック。
  * マルチコア対応。Intel Core i7-980Xでの実行結果。見事にすべてのCPUコアに負荷が分散していますｗ

http://bitspersampleconv2.googlecode.com/files/taskman.png

=== !SqWave2 バージョン 1.0.0 ===
  * 新規作成

=== !SqWave1 バージョン 1.0.0 ===
  * 新規作成。
  * 誤ってプロジェクトファイルを壊してしまったため廃棄