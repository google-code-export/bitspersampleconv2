#summary パルスを出力して録音し、WAVファイルを作成するPulse5

Pulse5はASIOデバイスから5波長分の長さのパルスを22.5Hz～20000Hzまでの1/3oct刻みで順に出力し、
同時にASIOデバイスから録音するプログラムです。

スピーカーのパルス応答の具合を観察するために作成しました。
ASIOデバイスは96kHz 24bit録音再生対応である必要があります。

ASIO4ALLでは駄目で本物のASIO2デバイスでないとうまく動作しないと思います。

大雑把なプログラムなのでASIO2対応で96kHz 24bit録音再生対応であっても
動作しないハードウェアも少なからずあると思われます。

=動作確認デバイス=

 * Creative X-Fi titanium PCI-e
 * M-AUDIO ProFire 2626

=ダウンロード=

http://bitspersampleconv2.googlecode.com/files/Pulse5103Setup.msi


=使用方法=

ASIOデバイス自体の性能を測るときは入力端子と出力端子をケーブルでつなげます。

スピーカーの性能を測るときはASIOデバイスの出力にスピーカーをつなげ、
マイク入力に測定用マイクをつなげます。

Pulse5を起動し、画面のグループボックス1～4まで設定を行ってStartを押すと再生と録音が始まります。

1個しかASIOデバイスがない場合は自動でそのデバイスのドライバがロードされるので
1のASIOドライバ選択を飛ばして2から設定してください。

2のPulse Countは何波長分のパルスを出力するか設定します。デフォルトは5波長出力です。

http://bitspersampleconv2.googlecode.com/files/Pulse5.png

=ソースコードからexeを作る方法=

Visual C++ 2008 express editionと
Visual C# 2008 express edition が必要です。
マイクロソフトのサイトからダウンロードします(無料)

http://www.steinberg.net/en/company/3rd_party_developer.html
からASIO SDKをダウンロードします(無料)

TortoiseSVNなどを使って
https://bitspersampleconv2.googlecode.com/svn/trunk/
からPulse5のソースコードをダウンロード(チェックアウト)します

チェックアウトしてきたツリーにASIO SDKをunzipしたものをコピーして
同じ親ディレクトリのなかにASIOSDK2とAsioIOがある状態にして
AsioIO\AsioIODLL\copyasiofiles.batを実行するとASIOSDKの中から
asio.cppなど9つのファイルをAsioIO\AsioIODLL\にコピーします

Visual C++を起動してAsioIO\AsioIO.slnを読み込みます。
AsioIODLLプロジェクトをビルドします。

できたAsioIODLL.dllとAsioIODLL.libをAsioTestGUI\bin\Debugにコピーします

VisualC#を起動してPulse5プロジェクトをデバッグビルドします

実行します

ASIOにアクセスするDLLはC++で作成。
ユーザーインターフェースはC#で作成したためこのような面倒なことになっています

ASIO is a trademark and software of Steinberg Media Technologies GmbH