#summary WASAPI排他モードでWAVファイルを再生
#labels Featured

= WASAPI排他モードでWAVファイルを再生 =

!PlayPcmWinはWASAPI排他モードのイベント駆動モデルでWAVファイルを再生するプログラムです。

Windows 7に対応しております。間違いなくWindows XPでは動きません。Windows Vista(SP1以降)では、動かないと思います。

*ビットマッチ出力するために作成したソフトウェアのため、最大音量で出力します。音量の調節機能はありません。音量はプリアンプで絞って下さい。*

=ダウンロード=

http://bitspersampleconv2.googlecode.com/files/PlayPcmWin103.zip

=使用方法=

zipを展開して、中のSetup.exeを実行してインストールし、
!PlayPcmWinを開き、再生するWAVファイルを指定して、
使用する出力デバイスを選択し、再生ボタンを押します。

アンインストールは、プログラムの追加と削除で行うか、もう一度Setup.exeを実行して削除を選びます。

http://bitspersampleconv2.googlecode.com/files/PlayPcmWin.png

=ソースコード=

閲覧だけなら:
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/PlayPcmWin
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WasapiCS
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WasapiIODLL
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WavRWLib2

ビルドしたい場合は、Sourceページに行ってソースコードをTortoiseSVNなどでチェックアウトしてきます。
!PlayPcmWin/!PlayPcmWin.slnをVS2010で開いてビルド。

=更新履歴=
===!PlayPcmWin 1.0.3 ==
  * サンプリング周波数等の設定に失敗したあとに、もう一度設定しようとすると異常終了する不具合を修正。
  * 量子化ビット数24ビットに対応したつもりだが、量子化ビット数24ビットの設定はうまくいかないようだ。

===!PlayPcmWin 1.0.1 ==
  * コンソールプログラムをやめてウィンドウが出るようにした。
  * .NET Framework 4.0 Client profileを使用。

===バージョン1.2 ===
  * ビットマッチ再生

===バージョン1.1===
  * 最終フレームのサイズが中途半端になって失敗する問題を修正。
  * 再生位置の変数をmutexで守るようにした。

===バージョン1.0===

  * 量子化ビット数16ビット、2チャンネル、非圧縮PCMのWAVEファイルに対応。
  * 音は一応鳴るが、最終フレームのバッファ確保のサイズ計算に問題があり、ほとんど必ず最後にエラーメッセージが出て終了します。