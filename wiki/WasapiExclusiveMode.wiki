#summary WASAPI排他モードでWAVファイルを再生
#labels Featured

= WASAPI排他モードでWAVファイルを再生 =

!PlayPcmWinはWASAPI排他モードのイベント駆動モデルでWAVファイルを再生するプログラムです。

Windows 7に対応しております。間違いなくWindows XPでは動きません。Windows Vistaでは、動かないと思います。

!PlayPcmWinは実験プログラムです。使いやすいとは言えません。WASAPI排他モードで音楽を聴きたい場合は、Foobar2000のfoo_out_wasapiプラグインを使うのが便利です。

*ビットマッチ出力するために作成したソフトウェアのため、最大音量で出力します。音量の調節機能はありません。CDプレーヤー等と同じです。音量はプリアンプで絞って下さい。*

=ダウンロード=

http://bitspersampleconv2.googlecode.com/files/PlayPcmWin110.zip

=使用方法=

zipを展開して、中のSetup.exeを実行してインストールし、
!PlayPcmWinを開き、再生するWAVファイルを指定して、
使用する出力デバイスを選択し、再生ボタンを押します。

アンインストールは、プログラムの追加と削除で行うか、もう一度Setup.exeを実行して削除を選びます。

http://bitspersampleconv2.googlecode.com/files/PlayPcmWin107.jpg

=ソースコード=

閲覧だけなら:
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/PlayPcmWin
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WasapiCS
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WasapiIODLL
  * http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/WavRWLib2

ビルドしたい場合は、Sourceページに行ってソースコードをTortoiseSVNなどでチェックアウトしてきます。
!PlayPcmWin/!PlayPcmWin.slnをVS2010で開いてビルド。

=参考文献=

http://msdn.microsoft.com/en-us/library/dd370844%28v=VS.85%29.aspx

=更新履歴=
===!PlayPcmWin 1.0.9 ==
  * 「対応フォーマット」ボタンを押したときにIAudioClient::GetDevicePeriodの値を表示するようにした。

===!PlayPcmWin 1.0.9 ==
  * 従来のイベント駆動モードに加えてタイマー駆動モードを追加。

===!PlayPcmWin 1.0.8 ==
  * インストーラープログラムを修正。

===!PlayPcmWin 1.0.7 ==
  * 量子化ビット数24ビット 2チャンネルのWAVファイルにも対応した。量子化ビット数24ビットでビットマッチ出力しているかどうかについては未調査。
  * デフォルトの出力レイテンシーを100msに設定。
  * 対応フォーマット一覧出力機能。

===!PlayPcmWin 1.0.5 ==
  * バージョン番号の上げ忘れを修正。

===!PlayPcmWin 1.0.4 ==
  * 出力レイテンシーをデフォルトの10ミリ秒以外に設定できるようにした。

===!PlayPcmWin 1.0.3 ==
  * サンプリング周波数等の設定に失敗したあとに、もう一度設定しようとすると異常終了する不具合を修正。

===!PlayPcmWin 1.0.1 ==
  * コンソールプログラムをやめてウィンドウが出るようにした。
  * .NET Framework 4.0 Client profileを使用。

===バージョン1.2 ===
  * ビットマッチ再生

===バージョン1.1===
  * 最終フレームのサイズが中途半端になって失敗する問題を修正。
  * 再生位置の変数をmutexで守るようにした。

===バージョン1.0===

  * 量子化ビット数16ビット、2チャンネル、非圧縮PCMのWAVEファイルに対応。
  * 音は一応鳴るが、最終フレームのバッファ確保のサイズ計算に問題があり、ほとんど必ず最後にエラーメッセージが出て終了します。