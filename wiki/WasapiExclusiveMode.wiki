#summary WASAPI排他モードでWAVファイルを再生
#labels Featured

= WASAPI排他モードでWAVファイルを再生 =

!PlayPcmはWASAPI排他モードでWAVファイルを再生するプログラムです。

Windows VistaとWindows 7に対応しております。

まだ作り中です。

*音量の調節機能はありません。最大音量で鳴ります。音量はプリアンプで絞って下さい。*

==ダウンロード==

http://bitspersampleconv2.googlecode.com/files/PlayPcm101.zip

==使用方法==

CMDを開いてzipを展開したディレクトリにcdして
{{{
playpcm
}}}

でデバイス一覧が出ます。
0番のデバイスにc:\data\001.wavを出力(再生)する場合は
{{{
playpcm -d 0 C:\data\001.wav
}}}
と入力します。

=ソースコード=

閲覧だけなら:
http://code.google.com/p/bitspersampleconv2/source/browse/#svn/trunk/PlayPcm

ビルドしたい場合は、Sourceページに行ってソースコードをTortoiseSVNなどでチェックアウトしてきます。
VS2010で開いてビルド。

=更新履歴=

===バージョン1.1===
  * 最終フレームのサイズが中途半端になって失敗する問題を修正。
  * 再生位置の変数をmutexで守るようにした。

===バージョン1.0===

  * 量子化ビット数16ビット
  * 2チャンネル
  * 非圧縮PCM
のWAVEファイルに対応。

音は一応鳴るが、最終フレームのバッファ確保のサイズ計算に問題があり、ほとんど必ず最後にエラーメッセージが出て終了します。